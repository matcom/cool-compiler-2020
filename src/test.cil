TYPES -->

	type Object {
		method abort:Object_abort
		method type_name:Object_type_name
		method copy:Object_copy
	}

	type IO {
		method out_string:IO_out_string
		method out_int:IO_out_int
		method in_string:IO_in_string
		method in_int:IO_in_int
		method abort:Object_abort
		method type_name:Object_type_name
		method copy:Object_copy
	}

	type String {
		method length:String_length
		method concat:String_concat
		method substr:String_substr
		method abort:Object_abort
		method type_name:Object_type_name
		method copy:Object_copy
	}

	type Int {
		method abort:Object_abort
		method type_name:Object_type_name
		method copy:Object_copy
	}

	type Bool {
		method abort:Object_abort
		method type_name:Object_type_name
		method copy:Object_copy
	}

	type Main {
		attribute out:Main
		attribute testee:Main
		attribute divisor:Main
		attribute stop:Main
		attribute m:Main
		method main:Main_main
		method out_string:IO_out_string
		method out_int:IO_out_int
		method in_string:IO_in_string
		method in_int:IO_in_int
		method abort:Object_abort
		method type_name:Object_type_name
		method copy:Object_copy
	}

END <--

DATA -->

	data_0 "2 is trivially prime.\n"
	data_1 " is prime.\n"
	data_2 "halt"
	data_3 "continue"

END <--

CODE -->

	function IO_out_string {
		PARAM self
		PARAM str
		PRINT str
		RETURN self
	}

	function IO_out_int {
		PARAM self
		PARAM int
		LOCAL local_0
		ALLOC local_0 String
		TOSTR local_0 int
		PRINT local_0
		RETURN self
	}

	function IO_in_string {
		PARAM self
		LOCAL local_1
		ALLOC local_1 String
		READ local_1
		RETURN local_1
	}

	function IO_in_int {
		PARAM self
		LOCAL local_2
		ALLOC local_2 Int
		RINT local_2
		RETURN local_2
	}

	function Object_type_name {
		PARAM self
		LOCAL local_3
		ALLOC local_3 String
		TYPE local_3 self
		RETURN local_3
	}

	function Object_copy {
		PARAM self
		LOCAL local_4
		COPY local_4 self
		RETURN local_4
	}

	function String_length {
		PARAM self
		LOCAL local_5
		ALLOC local_5 Int
		STRLEN local_5 self
		RETURN local_5
	}

	function String_concat {
		PARAM self
		PARAM str
		LOCAL local_6
		ALLOC local_6 String
		STRCAT local_6 self str
		RETURN local_6
	}

	function String_substr {
		PARAM self
		PARAM from
		PARAM to
		LOCAL local_7
		ALLOC local_7 String
		STRSUB local_7 self from to
		RETURN local_7
	}

	function Object_abort {
		PARAM self
		EXIT
	}

	function is_son {
		PARAM self
		PARAM class_s
		PARAM class_f
		LOCAL local_8
		LOCAL local_9
		LOCAL local_10
		ALLOC local_8 Bool
		ALLOC local_9 Bool
		ALLOC local_10 Int
		MOV local_10 2
		E local_8 class_s type_IO
		E local_9 class_f type_Object
		ADD local_8 local_8 local_9
		L local_8 local_8 local_10
		IF local_8 GOTO label_13
		MOV local_8 1
		RETURN local_8
		LABEL label_13
		E local_8 class_s type_String
		E local_9 class_f type_Object
		ADD local_8 local_8 local_9
		L local_8 local_8 local_10
		IF local_8 GOTO label_19
		MOV local_8 1
		RETURN local_8
		LABEL label_19
		E local_8 class_s type_Int
		E local_9 class_f type_Object
		ADD local_8 local_8 local_9
		L local_8 local_8 local_10
		IF local_8 GOTO label_25
		MOV local_8 1
		RETURN local_8
		LABEL label_25
		E local_8 class_s type_Bool
		E local_9 class_f type_Object
		ADD local_8 local_8 local_9
		L local_8 local_8 local_10
		IF local_8 GOTO label_31
		MOV local_8 1
		RETURN local_8
		LABEL label_31
		E local_8 class_s type_Main
		E local_9 class_f type_Object
		ADD local_8 local_8 local_9
		L local_8 local_8 local_10
		IF local_8 GOTO label_37
		MOV local_8 1
		RETURN local_8
		LABEL label_37
		E local_8 class_s type_Main
		E local_9 class_f type_IO
		ADD local_8 local_8 local_9
		L local_8 local_8 local_10
		IF local_8 GOTO label_39
		MOV local_8 1
		RETURN local_8
		LABEL label_39
		MOV local_8 0
		RETURN local_8
	}

	function Main_main {
		PARAM self
		LOCAL local_11
		ALLOC local_11 Int
		MOV local_11 0
		RETURN local_11
	}

	function main {
		LOCAL local_12
		LOCAL local_13
		LOCAL local_14
		LOCAL local_15
		LOCAL local_16
		LOCAL local_17
		LOCAL local_18
		LOCAL local_19
		LOCAL local_20
		LOCAL local_21
		LOCAL local_22
		LOCAL local_23
		LOCAL local_24
		LOCAL local_25
		LOCAL local_26
		LOCAL local_27
		LOCAL local_28
		LOCAL local_29
		LOCAL local_30
		LOCAL local_31
		LOCAL local_32
		LOCAL local_33
		LOCAL local_34
		LOCAL local_35
		LOCAL local_36
		LOCAL local_37
		LOCAL local_38
		LOCAL local_39
		LOCAL local_40
		LOCAL local_41
		LOCAL local_42
		LOCAL local_43
		LOCAL local_44
		LOCAL local_45
		LOCAL local_46
		LOCAL local_47
		LOCAL local_48
		LOCAL local_49
		LOCAL local_50
		LOCAL local_51
		LOCAL local_52
		LOCAL local_53
		LOCAL local_54
		LOCAL local_55
		LOCAL local_56
		LOCAL local_57
		LOCAL local_58
		LOCAL local_59
		LOCAL local_60
		LOCAL local_61
		LOCAL local_62
		LOCAL local_63
		LOCAL local_64
		LOCAL local_65
		LOCAL local_66
		LOCAL local_67
		LOCAL local_68
		LOCAL local_69
		LOCAL local_70
		LOCAL local_71
		LOCAL local_72
		LOCAL local_73
		LOCAL local_74
		LOCAL local_75
		LOCAL local_76
		LOCAL local_77
		LOCAL local_78
		LOCAL local_79
		ALLOC local_12 Main
		ALLOC local_15 IO
		ALLOC local_16 String
		LDATA local_16 data_0
		LOCALSAVE
		ARG self
		ARG local_16
		ALLOC local_18 String
		TYPE local_18 local_15
		CALL local_17 local_18 out_string
		ALLOC local_19 Int
		MOV local_19 2
		SATTR local_12 out local_19
		ALLOC local_21 Int
		GATTR local_21 local_12 out
		SATTR local_12 testee local_21
		ALLOC local_22 Int
		SATTR local_12 divisor local_22
		ALLOC local_24 Int
		MOV local_24 500
		SATTR local_12 stop local_24
		ALLOC local_78 void
		LABEL label_54
		ALLOC local_26 Bool
		MOV local_26 1
		IF local_26 GOTO label_55
		GOTO label_56
		LABEL label_55
		ALLOC local_27 Int
		GATTR local_27 local_12 testee
		ALLOC local_28 Int
		MOV local_28 1
		ALLOC local_29 Int
		ADD local_29 local_27 local_28
		SATTR local_12 testee local_29
		ALLOC local_30 Int
		MOV local_30 2
		SATTR local_12 divisor local_30
		ALLOC local_53 void
		LABEL label_47
		ALLOC local_49 Bool
		ALLOC local_35 Bool
		ALLOC local_31 Int
		GATTR local_31 local_12 testee
		ALLOC local_32 Int
		GATTR local_32 local_12 divisor
		ALLOC local_33 Int
		GATTR local_33 local_12 divisor
		ALLOC local_34 Int
		Mul local_34 local_32 local_33
		L local_35 local_31 local_34
		IF local_35 GOTO label_45
		ALLOC local_48 Bool
		ALLOC local_45 Bool
		ALLOC local_37 Int
		GATTR local_37 local_12 testee
		ALLOC local_38 Int
		GATTR local_38 local_12 divisor
		ALLOC local_39 Int
		GATTR local_39 local_12 testee
		ALLOC local_40 Int
		GATTR local_40 local_12 divisor
		ALLOC local_41 Int
		Div local_41 local_39 local_40
		ALLOC local_42 Int
		Mul local_42 local_38 local_41
		ALLOC local_43 Int
		SUB local_43 local_37 local_42
		ALLOC local_44 Int
		MOV local_44 0
		E local_45 local_43 local_44
		IF local_45 GOTO label_43
		ALLOC local_47 Bool
		MOV local_47 1
		MOV local_48 local_47
		GOTO label_44
		LABEL label_43
		ALLOC local_46 Bool
		MOV local_46 0
		MOV local_48 local_46
		LABEL label_44
		MOV local_49 local_48
		GOTO label_46
		LABEL label_45
		ALLOC local_36 Bool
		MOV local_36 0
		MOV local_49 local_36
		LABEL label_46
		IF local_49 GOTO label_48
		GOTO label_49
		LABEL label_48
		ALLOC local_50 Int
		GATTR local_50 local_12 divisor
		ALLOC local_51 Int
		MOV local_51 1
		ALLOC local_52 Int
		ADD local_52 local_50 local_51
		SATTR local_12 divisor local_52
		GOTO label_47
		LABEL label_49
		ALLOC local_69 Bool
		ALLOC local_58 Bool
		ALLOC local_54 Int
		GATTR local_54 local_12 testee
		ALLOC local_55 Int
		GATTR local_55 local_12 divisor
		ALLOC local_56 Int
		GATTR local_56 local_12 divisor
		ALLOC local_57 Int
		Mul local_57 local_55 local_56
		L local_58 local_54 local_57
		IF local_58 GOTO label_50
		ALLOC local_68 Int
		MOV local_68 0
		MOV local_69 local_68
		GOTO label_51
		LABEL label_50
		ALLOC local_59 Int
		GATTR local_59 local_12 testee
		SATTR local_12 out local_59
		ALLOC local_60 IO
		ALLOC local_61 Int
		GATTR local_61 local_12 out
		LOCALSAVE
		ARG self
		ARG local_61
		ALLOC local_63 String
		TYPE local_63 local_60
		CALL local_62 local_63 out_int
		ALLOC local_64 IO
		ALLOC local_65 String
		LDATA local_65 data_1
		LOCALSAVE
		ARG self
		ARG local_65
		ALLOC local_67 String
		TYPE local_67 local_64
		CALL local_66 local_67 out_string
		MOV local_69 local_66
		LABEL label_51
		ALLOC local_77 Bool
		ALLOC local_72 Bool
		ALLOC local_70 Int
		GATTR local_70 local_12 stop
		ALLOC local_71 Int
		GATTR local_71 local_12 testee
		LE local_72 local_70 local_71
		IF local_72 GOTO label_52
		ALLOC local_76 String
		LDATA local_76 data_3
		MOV local_77 local_76
		GOTO label_53
		LABEL label_52
		ALLOC local_73 String
		LDATA local_73 data_2
		LOCALSAVE
		ARG local_73
		ALLOC local_75 String
		TYPE local_75 local_73
		CALL local_74 local_75 abort
		MOV local_77 local_74
		LABEL label_53
		GOTO label_54
		LABEL label_56
		SATTR local_12 m local_78
		LOCALSAVE
		ARG local_12
		ALLOC local_79 String
		SETSTR local_79 Main
		CALL local_13 local_79 main
	}

END <--