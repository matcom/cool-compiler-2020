TYPES -->

	type Object {
		method abort:Object_abort
		method type_name:Object_type_name
		method copy:Object_copy
	}

	type IO {
		method out_string:IO_out_string
		method out_int:IO_out_int
		method in_string:IO_in_string
		method in_int:IO_in_int
		method abort:Object_abort
		method type_name:Object_type_name
		method copy:Object_copy
	}

	type String {
		method length:String_length
		method concat:String_concat
		method substr:String_substr
		method abort:Object_abort
		method type_name:Object_type_name
		method copy:Object_copy
	}

	type Int {
		method abort:Object_abort
		method type_name:Object_type_name
		method copy:Object_copy
	}

	type Bool {
		method abort:Object_abort
		method type_name:Object_type_name
		method copy:Object_copy
	}

	type Book {
		attribute title:Book
		attribute author:Book
		method initBook:Book_initBook
		method print:Book_print
		method out_string:IO_out_string
		method out_int:IO_out_int
		method in_string:IO_in_string
		method in_int:IO_in_int
		method abort:Object_abort
		method type_name:Object_type_name
		method copy:Object_copy
	}

	type Article {
		attribute title:Book
		attribute author:Book
		attribute per_title:Article
		method initArticle:Article_initArticle
		method print:Article_print
		method initBook:Book_initBook
		method out_string:IO_out_string
		method out_int:IO_out_int
		method in_string:IO_in_string
		method in_int:IO_in_int
		method abort:Object_abort
		method type_name:Object_type_name
		method copy:Object_copy
	}

	type BookList {
		method isNil:BookList_isNil
		method cons:BookList_cons
		method car:BookList_car
		method cdr:BookList_cdr
		method print_list:BookList_print_list
		method out_string:IO_out_string
		method out_int:IO_out_int
		method in_string:IO_in_string
		method in_int:IO_in_int
		method abort:Object_abort
		method type_name:Object_type_name
		method copy:Object_copy
	}

	type Cons {
		attribute xcar:Cons
		attribute xcdr:Cons
		method isNil:Cons_isNil
		method init:Cons_init
		method car:Cons_car
		method cdr:Cons_cdr
		method print_list:Cons_print_list
		method cons:BookList_cons
		method out_string:IO_out_string
		method out_int:IO_out_int
		method in_string:IO_in_string
		method in_int:IO_in_int
		method abort:Object_abort
		method type_name:Object_type_name
		method copy:Object_copy
	}

	type Nil {
		method isNil:Nil_isNil
		method print_list:Nil_print_list
		method cons:BookList_cons
		method car:BookList_car
		method cdr:BookList_cdr
		method out_string:IO_out_string
		method out_int:IO_out_int
		method in_string:IO_in_string
		method in_int:IO_in_int
		method abort:Object_abort
		method type_name:Object_type_name
		method copy:Object_copy
	}

	type Main {
		attribute books:Main
		method main:Main_main
		method abort:Object_abort
		method type_name:Object_type_name
		method copy:Object_copy
	}

END <--

DATA -->

	data_0 "title:      "
	data_1 "\n"
	data_2 "author:     "
	data_3 "\n"
	data_4 "periodical:  "
	data_5 "\n"
	data_6 "- dynamic type was Book -\n"
	data_7 "- dynamic type was Article -\n"
	data_8 "Compilers, Principles, Techniques, and Tools"
	data_9 "Aho, Sethi, and Ullman"
	data_10 "The Top 100 CD_ROMs"
	data_11 "Ulanoff"
	data_12 "PC Magazine"

END <--

CODE -->

	function IO_out_string {
		PARAM self
		PARAM str
		PRINT str
		RETURN self
	}

	function IO_out_int {
		PARAM self
		PARAM int
		PINT int
		RETURN self
	}

	function IO_in_string {
		PARAM self
		LOCAL local_0
		ALLOC local_0 String
		READ local_0
		RETURN local_0
	}

	function IO_in_int {
		PARAM self
		LOCAL local_1
		ALLOC local_0 Int
		RINT local_0
		RETURN local_0
	}

	function Object_type_name {
		PARAM self
		LOCAL local_2
		LOCAL local_3
		ALLOC local_0 Int
		ALLOC local_1 String
		TYPE local_0 self
		TYPENAME local_1 local_0
		RETURN local_1
	}

	function Object_copy {
		PARAM self
		LOCAL local_4
		COPY local_0 self
		RETURN local_0
	}

	function String_length {
		PARAM self
		LOCAL local_5
		ALLOC local_0 Int
		STRLEN local_0 self
		RETURN local_0
	}

	function String_concat {
		PARAM self
		PARAM str
		LOCAL local_6
		ALLOC local_0 String
		STRCAT local_0 self str
		RETURN local_0
	}

	function String_substr {
		PARAM self
		PARAM from
		PARAM to
		LOCAL local_7
		ALLOC local_0 String
		STRSUB local_0 self from to
		RETURN local_0
	}

	function Object_abort {
		PARAM self
		LOCAL local_8
		ALLOC local_0 Int
		TYPE local_0 self
		EXIT
	}

	function Object_Attributes_Initialization {
		PARAM instance
		LOCAL local_0
		ALLOC local_0 void
		RETURN local_0
	}

	function IO_Attributes_Initialization {
		PARAM instance
		LOCAL local_0
		ALLOC local_0 void
		RETURN local_0
	}

	function String_Attributes_Initialization {
		PARAM instance
		LOCAL local_0
		ALLOC local_0 void
		RETURN local_0
	}

	function Int_Attributes_Initialization {
		PARAM instance
		LOCAL local_0
		ALLOC local_0 void
		RETURN local_0
	}

	function Bool_Attributes_Initialization {
		PARAM instance
		LOCAL local_0
		ALLOC local_0 void
		RETURN local_0
	}

	function Book_Attributes_Initialization {
		PARAM instance
		LOCAL local_0
		ALLOC local_0 void
		SATTR instance title local_0
		SATTR instance author local_0
		RETURN local_0
	}

	function Book_initBook {
		PARAM self
		PARAM title_p
		PARAM author_p
		SATTR self title title_p
		SATTR self author author_p
		RETURN self
	}

	function Book_print {
		PARAM self
		LOCAL local_0
		LOCAL local_1
		LOCAL local_2
		LOCAL local_3
		LOCAL local_4
		LOCAL local_5
		LOCAL local_6
		LOCAL local_7
		LOCAL local_8
		LOCAL local_9
		LOCAL local_10
		LOCAL local_11
		LOCAL local_12
		LOCAL local_13
		LOCAL local_14
		LOCAL local_15
		LOCAL local_16
		ALLOC local_0 String
		LDATA local_0 data_0
		LOCALSAVE
		ARG self
		ARG local_0
		ALLOC local_2 Int
		TYPE local_2 self
		CALL local_1 local_2 out_string
		GATTR local_3 self title
		LOCALSAVE
		ARG local_1
		ARG local_3
		ALLOC local_5 Int
		TYPE local_5 local_1
		CALL local_4 local_5 out_string
		ALLOC local_6 String
		LDATA local_6 data_5
		LOCALSAVE
		ARG local_4
		ARG local_6
		ALLOC local_8 Int
		TYPE local_8 local_4
		CALL local_7 local_8 out_string
		ALLOC local_9 String
		LDATA local_9 data_2
		LOCALSAVE
		ARG self
		ARG local_9
		ALLOC local_11 Int
		TYPE local_11 self
		CALL local_10 local_11 out_string
		GATTR local_12 self author
		LOCALSAVE
		ARG local_10
		ARG local_12
		ALLOC local_14 Int
		TYPE local_14 local_10
		CALL local_13 local_14 out_string
		LOCALSAVE
		ARG local_13
		ARG local_6
		ALLOC local_16 Int
		TYPE local_16 local_13
		CALL local_15 local_16 out_string
		RETURN self
	}

	function Article_Attributes_Initialization {
		PARAM instance
		LOCAL local_0
		ALLOC local_0 void
		SATTR instance title local_0
		SATTR instance author local_0
		SATTR instance per_title local_0
		RETURN local_0
	}

	function Article_initArticle {
		PARAM self
		PARAM title_p
		PARAM author_p
		PARAM per_title_p
		LOCAL local_0
		LOCAL local_1
		LOCALSAVE
		ARG self
		ARG title_p
		ARG author_p
		ALLOC local_1 Int
		TYPE local_1 self
		CALL local_0 local_1 initBook
		SATTR self per_title per_title_p
		RETURN self
	}

	function Article_print {
		PARAM self
		LOCAL local_0
		LOCAL local_1
		LOCAL local_2
		LOCAL local_3
		LOCAL local_4
		LOCAL local_5
		LOCAL local_6
		LOCAL local_7
		LOCAL local_8
		LOCAL local_9
		LOCAL local_10
		LOCALSAVE
		ARG self
		ALLOC local_1 Int
		TYPEADDR local_1 Book
		CALL local_0 local_1 print
		ALLOC local_2 String
		LDATA local_2 data_4
		LOCALSAVE
		ARG self
		ARG local_2
		ALLOC local_4 Int
		TYPE local_4 self
		CALL local_3 local_4 out_string
		GATTR local_5 self per_title
		LOCALSAVE
		ARG local_3
		ARG local_5
		ALLOC local_7 Int
		TYPE local_7 local_3
		CALL local_6 local_7 out_string
		ALLOC local_8 String
		LDATA local_8 data_5
		LOCALSAVE
		ARG local_6
		ARG local_8
		ALLOC local_10 Int
		TYPE local_10 local_6
		CALL local_9 local_10 out_string
		RETURN self
	}

	function BookList_Attributes_Initialization {
		PARAM instance
		LOCAL local_0
		ALLOC local_0 void
		RETURN local_0
	}

	function BookList_isNil {
		PARAM self
		LOCAL local_0
		LOCAL local_1
		LOCAL local_2
		LOCALSAVE
		ARG self
		ALLOC local_1 Int
		TYPE local_1 self
		CALL local_0 local_1 abort
		ALLOC local_2 Bool
		MOV local_2 1
		RETURN local_2
	}

	function BookList_cons {
		PARAM self
		PARAM hd
		LOCAL local_0
		LOCAL local_1
		LOCAL local_2
		LOCAL local_3
		ALLOC local_0 Cons
		ALLOC local_1 Cons
		MOV local_1 local_0
		LOCALSAVE
		ARG local_1
		ARG hd
		ARG self
		ALLOC local_3 Int
		TYPE local_3 local_1
		CALL local_2 local_3 init
		RETURN local_2
	}

	function BookList_car {
		PARAM self
		LOCAL local_0
		LOCAL local_1
		LOCAL local_2
		LOCALSAVE
		ARG self
		ALLOC local_1 Int
		TYPE local_1 self
		CALL local_0 local_1 abort
		ALLOC local_2 Book
		RETURN local_2
	}

	function BookList_cdr {
		PARAM self
		LOCAL local_0
		LOCAL local_1
		LOCAL local_2
		LOCALSAVE
		ARG self
		ALLOC local_1 Int
		TYPE local_1 self
		CALL local_0 local_1 abort
		ALLOC local_2 BookList
		RETURN local_2
	}

	function BookList_print_list {
		PARAM self
		LOCAL local_0
		LOCAL local_1
		LOCALSAVE
		ARG self
		ALLOC local_1 Int
		TYPE local_1 self
		CALL local_0 local_1 abort
		RETURN local_0
	}

	function Cons_Attributes_Initialization {
		PARAM instance
		LOCAL local_0
		ALLOC local_0 void
		SATTR instance xcar local_0
		SATTR instance xcdr local_0
		RETURN local_0
	}

	function Cons_isNil {
		PARAM self
		LOCAL local_0
		ALLOC local_0 Bool
		MOV local_0 0
		RETURN local_0
	}

	function Cons_init {
		PARAM self
		PARAM hd
		PARAM tl
		SATTR self xcar hd
		SATTR self xcdr tl
		RETURN self
	}

	function Cons_car {
		PARAM self
		LOCAL local_0
		GATTR local_0 self xcar
		RETURN local_0
	}

	function Cons_cdr {
		PARAM self
		LOCAL local_0
		GATTR local_0 self xcdr
		RETURN local_0
	}

	function Cons_print_list {
		PARAM self
		LOCAL local_0
		LOCAL local_1
		LOCAL local_2
		LOCAL local_3
		LOCAL local_4
		LOCAL local_5
		LOCAL local_6
		LOCAL local_7
		LOCAL local_8
		LOCAL local_9
		LOCAL local_10
		LOCAL local_11
		LOCAL local_12
		LOCAL local_13
		LOCAL local_14
		LOCAL local_15
		LOCAL local_16
		LOCAL local_17
		GATTR local_0 self xcar
		LOCALSAVE
		ARG local_0
		ALLOC local_2 Int
		TYPE local_2 local_0
		CALL local_1 local_2 print
		ALLOC local_3 Int
		TYPE local_3 local_1
		ALLOC local_4 Int
		TYPEADDR local_4 Article
		ALLOC local_5 Int
		TYPEADDR local_5 Book
		ALLOC local_7 Bool
		ISSON local_3 local_4 local_7
		IF local_7 GOTO label_1
		ALLOC local_8 Bool
		ISSON local_3 local_5 local_8
		IF local_8 GOTO label_2
		GOTO label_3
		LABEL label_1
		ALLOC local_9 String
		LDATA local_9 data_7
		LOCALSAVE
		ARG self
		ARG local_9
		ALLOC local_11 Int
		TYPE local_11 self
		CALL local_10 local_11 out_string
		MOV local_6 local_10
		GOTO label_3
		LABEL label_2
		ALLOC local_12 String
		LDATA local_12 data_6
		LOCALSAVE
		ARG self
		ARG local_12
		ALLOC local_14 Int
		TYPE local_14 self
		CALL local_13 local_14 out_string
		MOV local_6 local_13
		GOTO label_3
		LABEL label_3
		GATTR local_15 self xcdr
		LOCALSAVE
		ARG local_15
		ALLOC local_17 Int
		TYPE local_17 local_15
		CALL local_16 local_17 print_list
		RETURN local_16
	}

	function Nil_Attributes_Initialization {
		PARAM instance
		LOCAL local_0
		ALLOC local_0 void
		RETURN local_0
	}

	function Nil_isNil {
		PARAM self
		LOCAL local_0
		ALLOC local_0 Bool
		MOV local_0 1
		RETURN local_0
	}

	function Nil_print_list {
		PARAM self
		LOCAL local_0
		ALLOC local_0 Bool
		MOV local_0 1
		RETURN local_0
	}

	function Main_Attributes_Initialization {
		PARAM instance
		LOCAL local_0
		ALLOC local_0 void
		SATTR instance books local_0
		RETURN local_0
	}

	function Main_main {
		PARAM self
		LOCAL local_0
		LOCAL local_1
		LOCAL local_2
		LOCAL local_3
		LOCAL local_4
		LOCAL local_5
		LOCAL local_6
		LOCAL local_7
		LOCAL local_8
		LOCAL local_9
		LOCAL local_10
		LOCAL local_11
		LOCAL local_12
		LOCAL local_13
		LOCAL local_14
		LOCAL local_15
		LOCAL local_16
		LOCAL local_17
		LOCAL local_18
		LOCAL local_19
		LOCAL local_20
		ALLOC local_0 Book
		ALLOC local_1 String
		LDATA local_1 data_8
		ALLOC local_2 String
		LDATA local_2 data_9
		LOCALSAVE
		ARG local_0
		ARG local_1
		ARG local_2
		ALLOC local_4 Int
		TYPE local_4 local_0
		CALL local_3 local_4 initBook
		ALLOC local_5 Book
		MOV local_5 local_3
		ALLOC local_6 Article
		ALLOC local_7 String
		LDATA local_7 data_10
		ALLOC local_8 String
		LDATA local_8 data_11
		ALLOC local_9 String
		LDATA local_9 data_12
		LOCALSAVE
		ARG local_6
		ARG local_7
		ARG local_8
		ARG local_9
		ALLOC local_11 Int
		TYPE local_11 local_6
		CALL local_10 local_11 initArticle
		ALLOC local_12 Article
		MOV local_12 local_10
		ALLOC local_13 Nil
		LOCALSAVE
		ARG local_13
		ARG local_5
		ALLOC local_15 Int
		TYPE local_15 local_13
		CALL local_14 local_15 cons
		LOCALSAVE
		ARG local_14
		ARG local_12
		ALLOC local_17 Int
		TYPE local_17 local_14
		CALL local_16 local_17 cons
		SATTR self books local_16
		GATTR local_18 self books
		LOCALSAVE
		ARG local_18
		ALLOC local_20 Int
		TYPE local_20 local_18
		CALL local_19 local_20 print_list
		RETURN local_19
	}

	function main {
		LOCAL local_0
		LOCAL local_1
		LOCAL local_0
		LOCAL local_3
		ALLOC local_0 Main
		LOCALSAVE
		ARG local_0
		ALLOC local_3 Int
		TYPE local_3 local_0
		CALL local_1 local_3 main
	}

END <--